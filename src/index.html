<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ScreenshotToSlack</title>
    <style>
      html, body {
        width: 100%;
        height: 100%;
      }
      .main {
        background-color: rgba(0,0,0,0.5);
        width: 100%;
        height: 100%;
      }
      footer {
        background-color: rgba(255,255,255,0.5);
        bottom: 0;
        position: absolute;
        width: 100%;
      }
      button {
        margin: 5px;
      }
    </style>
    <script type="text/javascript">
      var request = require('request');

      function screenShot(){
        let remote = require('electron').remote
        remote.getCurrentWindow().capturePage(function handleCapture (img) {
          remote.require('fs').writeFile("hoge", img.toPng(), function(){
            console.log(img.toPng())
            postSlack(img.toPng())
          })
        })
      }

      function postSlack(img){
        var Slack = require('slack-node');
        slack = new Slack();
        slack.setWebhook("");
        slack.webhook({
          channel: "#general",
          username: "webhookbot",
          text: img,
          attachments: img
        }, function(err, response) {
          console.log(response);
        });
      }
    </script>
  </head>
  <body style="-webkit-app-region: drag">
    <div class='main'>
      <footer>
        <button onclick="screenShot()">
          Shot
        </button>
      </footer>
    </div>
  </body>
</html>
